% arara: pdflatex: { synctex: yes }
% arara: makeindex: { style: ctuthesis }
% arara: bibtex

% The class takes all the key=value arguments that \ctusetup does,
% and a couple more: draft and oneside
\documentclass[twoside]{ctuthesis}
\usepackage{graphicx}
\usepackage[sortlocale=cs_CZ, sorting=debug, style=iso-numeric, maxnames=2]{biblatex}
\usepackage{array,etoolbox}
\preto\tabular{\setcounter{magicrownumbers}{0}}
\newcounter{magicrownumbers}
\newcommand\rownumber{\stepcounter{magicrownumbers}\arabic{magicrownumbers}}

\usepackage{indentfirst}
\graphicspath{{img/}}
\renewcommand*{\finalnamedelim}{ a }
\ctusetup{
	mainlanguage = czech,
	otherlanguages = {slovak, english},
	title-czech = {Mobilní aplikace pro plánování lidských zdrojů},
	title-english = {TODO},
	doctype = S,
	faculty = F3,
	department-czech = {Katedra počítačů},
	department-english = {Department of Computer Science},
	author = {Martina Kopecká},
	supervisor = {Prof. Krutoš Spravedlivý},
	supervisor-address = {TODO},
	fieldofstudy-english = {Software Engineering -- TODO, co je ENG nazev},
	fieldofstudy-czech = {Softwarové inženýrství a technologie},
	keywords-czech = {slovo, klíč},
	keywords-english = {word, key},
	day = 1,
	month = 1,
	year = 2021,
	pkg-listings = true,
}

\ctuprocess

\addto\ctucaptionsczech{%
	\def\supervisorname{Vedoucí}%
	\def\subfieldofstudyname{Studijní program}%
}

\ctutemplateset{maketitle twocolumn default}{
	\begin{twocolumnfrontmatterpage}
		\ctutemplate{twocolumn.thanks}
		\ctutemplate{twocolumn.declaration}
		\ctutemplate{twocolumn.abstract.in.titlelanguage}
		\ctutemplate{twocolumn.abstract.in.secondlanguage}
		\ctutemplate{twocolumn.tableofcontents}
		\ctutemplate{twocolumn.listoffigures}
	\end{twocolumnfrontmatterpage}
}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.88,0.96,0.98}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
		extendedchars=false,
    inputencoding=utf8,
		texcl=true,
		literate={é}{{\'e}}1
           {č}{{\v{c}}}1
           {ľ}{{\v{l}}}1
           {ť}{{\v{t}}}1
           {ý}{{\'y}}1
           {ě}{{\v{e}}}1
           {ř}{{\v{r}}}1
           {š}{{\v{s}}}1
           {ž}{{\v{z}}}1
           {á}{{\'a}}1
           {í}{{\'i}}1
           {ó}{{\'o}}1
           {ň}{{\v{n}}}1
           {ď}{{\v{d}}}1
           {ú}{{\'u}}1
           {ů}{{\r{u}}}1
           {ĺ}{{\v{l}}}1
}


\setlength{\parskip}{0.5em}
% \setlength{\parskip}{5ex plus 0.2ex minus 0.2ex}

% Abstract in Czech
\begin{abstract-czech}
Český abstrakt
\end{abstract-czech}

% Abstract in English
\begin{abstract-english}
English abstract
\end{abstract-english}

% Acknowledgements / Podekovani
\begin{thanks}
Děkuji ČVUT, že mi je tak dobrou \emph{alma mater}.
\end{thanks}

% Declaration / Prohlaseni
\begin{declaration}
Prohlašuji, že jsem předloženou práci vypracovala samostatně s~použitím uvedené literatury.

V Praze, \ctufield{day}.~\monthinlanguage{title}~\ctufield{year}
\end{declaration}

\DeclareLabeldate[article]{
  \field{date}
  \field{year}
  \field{eventdate}
  \field{origdate}
  \field{urldate}
}

\addbibresource{bibliography.bib}
\lstset{style=mystyle}

\begin{document}

% \maketitle
%
% \chapter{Úvod}
% TODO


\chapter{Analýza problematiky}
Následující kapitola bude věnována analýze problematiky plánování zdrojů, a to jednak z~hlediska terminologie, jednak z~hlediska manažerského a právního (důraz je zde kladen především na pracovní dobu a typy pracovněprávních vztahů v~české legislativě a rozdíly mezi nimi).

\section{Definice a terminologie}

Řízení lidských zdrojů (angl. human resource management\footnote{Také se užívá pojem people management, neboť pojem human resources může mít negativní konotace a~značit, že lidé jsou zdrojem ve výrobě jako cokoli jiného. \cite[s.~1]{armstrong2014} Samotné spojení human resources se používá ve spojitosti s~personálním oddělením v~rámci organizace. }) je definováno jako komplexní přístup k~zaměstnávání a rozvoji osob. Pojem zahrnuje všechny aspekty toho, jak jsou osoby zaměstnány a řízeny v~rámci organizace. \cite[s.~1]{armstrong2014}

Dalším termínem užívaným v~literatuře je pracovní síla (angl. workforce nebo manpower), resp. její plánování, jedná se o základní proces řízení lidských zdrojů, který je utvářen strategií organizace a jeho cílem je zajistit, aby správný počet lidí se správnými schopnostmi, na správném místě, ve správném čase, za správnou cenu a~ve správném pracovněprávním poměru pomáhal organizaci dosáhnout jejích cílů. \cite{cipd2020_workforce} Mezi kroky tohoto procesu dle \cite{cipd2020_workforce} patří:
\begin{itemize}
	\item analýza aktuální personální situace;
	\item stanovení budoucích potřeb;
	\item identifikace současných nedostatků vzhledem k~plánu do budoucna;
	\item podnikání akcí k~odstranění nedostatků;
	\item monitorování a evaluace akcí.
\end{itemize}

[Kde si v~tom systému stojí rozvrhování???]



\section{Rozhodující faktory při plánování}
% PESTLE analyza

\subsection{Pracovní síly}
V rámci organizace mohou existovat rozdíly mezi jednotlivými pracovníky. Jen část zaměstnanců tak bude pracovat na plný úvazek, jiní mohou pracovat méně hodin, například pouze v nejvytíženějších dnech \cite{lin2015}. V případě těchto zaměstnanců, kteří pracují méně hodin (a ne vždy pravidelně), je třeba zohlednit různé typy pracovněprávních vztahů, čemuž bude věnován prostor dále v~podkapitole \ref{section:legislativa}.
% Individualitu zaměstnanců je třeba zohlednit i z~důvodu rozdílů mezi jejich schopnostmi.
% Dalším hlediskem, které je vhodné brát v~úvahu, je i spokojenost zaměstnanců, jejich časové možnosti a preference.

\subsection{Směny}
\label{sub:smeny}
Jednotlivé organizace se od sebe mohou lišit způsobem, jakým vypisují směny. Existují tak podniky, kde je rozvrh práce pravidelný a stejný pro všechny zaměstnance, ale i ty, kde je provoz dvou- nebo i třísměnný, rozvrh směn je sestavován cyklicky a začátek směn daného zaměstnance se v~jednotlivých dnech liší (nejčastěji směny začínají ráno, odpoledne nebo v~noci). Mezi organizace s~cyklicky sestavovaným rozvhem se řadí nejčastěji provozy, které operují 7~dní v~týdnu, například nemocnice, vězení, policie nebo také restaurace a pobočky řetězců rychlého občerstvení \cite{bechtold1981work}.

Nepravidelný rozvrh směn přitom může mít pro zaměstnance nežádoucí zdravotní účinky, \cite{flo2013shift} uvádí, že zaměstnanci ve vícesměnném provozu trpí nespavostí více než zbytek populace, a to především v~případě, že je mezi směnami kratší než 11hodinová přestávka, [TODO další zdravotní rizika].

\subsection{Úkoly}
% TODO -- může to být sekvence činností při směně nebo fakt, že teď pracuje organizace na něčem?

V~případě, že zaměstnanci jsou při práci vystaveni zdravotním rizikům, je vhodné během směny rozdělit úkoly tak, aby riziko bylo minimalizováno. \cite{wongwien2013ergonomic}

% Provozní úkoly (angl. operational tasks) jsou běžné činnosti, které musí během dne zaměstnanci vykonat \cite{lin2015}. Při jejich plnění se přitom nevytváří nový produkt, ale udržuje se chod organizace (např. se jedná o~administrativní úkoly). Lze je rozdělit na prioritní, plánované a neplánované \cite{miwa2010}.

\subsection{Předpověď poptávky po personálu}
\label{sub:demand}
Obecně řečeno musí zaměstnanci plnit úkoly podle toho, jaké události nastanou. Modelováním poptávky se rozumí proces, jehož výstupem je předpověď přibližného počtu zaměstnanců a jejich očekávaných kompetencí \cite[s.~219]{armstrong2014}, a to na základě očekávaných událostí \cite{ernst2004staff}.
Například prodejce hraček tedy na základě historických dat ví, že nejvíce zákazníků přichází před Vánoci a předpokládá, že tomu tak bude i v~následujícím roce. Na tuto událost bude reagovat tím, že se rozhodne rozšířit otevírací dobu. To celkově zvýší poptávku po personálu.

\subsection{Cena}
Dalším důležitým faktorem při plánování pracovních sil je celková cena lidské práce a otázka její optimalizace při naplnění poptávky.


\section{Legislativní podmínky}
\label{section:legislativa}
Hlavním právním předpisem, který se upravuje problematiku pracovních sil, je v~českém prostředí zákoník práce, který upravuje vztahy vznikající při výkonu závislé práce mezi zaměstnanci a~zaměstnavateli, tedy pracovněprávní vztahy \cite{zakon06_262}.

Zaměstnavatel je dle §~38 zákoníku práce povinen přidělovat zaměstnanci práci podle pracovní smlouvy. Zaměstnanec je pak povinen podle pokynů zaměstnavatele konat osobně práci v~rozvržené týdenní pracovní době.

\subsection{Pracovní doba}
Pracovní dobou se rozumí doba, v~níž je zaměstnanec povinen vykonávat práci pro zaměstnavatele nebo je k tomu na pracovišti připraven. Doba odpočinku není součástí pracovní doby. (§ 78 zákoníku práce)

Stanovená týdenní pracovní doba činí dle §~79 zákoníku práce 40~hodin (mimo výjimky). Pracovní dobu rozvrhuje zaměstnavatel, který určuje začátek a konec směn, a to zpravidla do pětidenního pracovního týdne (§ 81). Délka směny nesmí přesáhnout 12~hodin. U nezletilých zaměstnanců pak nesmí délka směny v~jednotlivém dni překročit 8~hodin a v~jednom týdnu 40~hodin.

\subsection{Rozvrh pracovní doby}
Zaměstnavatel je dle §~84 zákoníku práce povinen vypracovat rozvrh týdenní pracovní doby a seznámit s~ním nebo jeho změnou zaměstnance nejpozději 2~týdny předem (mimo výjimky stanovené zákonem nebo v~případě existence jiné dohody mezi zaměstnancem a zaměstnavatelem). Tento rozvrh musí být v~písemné formě. Pracovní dobu je podle §~90 třeba rozvrhovat s ohledem na nepřetržitý odpočinek mezi koncem jedné směny a začátkem následující (pro zletilé zaměstnance alespoň 11 hodin, pro nezletilé zaměstnance alespoň 12 hodin, v~zákonem stanovených výjimkách lze za určitých podmínek odpočinek zkrátit).

\subsection{Směna, směnný provoz}
TODO

\subsection{Pracovní poměr}
Pracovní poměr mezi zaměstnancem a zaměstnavatelem se podle §~33, odst.~1 zákoníku práce zakládá pracovní smlouvou. Zaměstnavatel má zajišťovat plnění svých úkolů především zaměstnanci v pracovním poměru (§ TODO).

\subsection{Přesčasy}
TODO

\subsection{Zkrácený úvazek}
Podle §~80 zákoníku práce může být mezi zaměstnancem a~zaměstnavatelem sjednána kratší pracovní doba.

\subsection{Dohody o pracích konaných mimo pracovní poměr}
§~77 zákoníku práce stanovuje, že na práci konanou na základě dohod o pracích konaných mimo pracovní poměr se vztahuje úprava pro výkon práce v~pracovním poměru, a to mimo výjimky uvedené v odst.~2 tohoto paragrafu (např. pracovní dobu a~dobu odpočinku nebo dovolenou). Podle §~74 přitom zaměstavatel není zaměstnancům na dohody povinen rozvrhnout pracovní dobu.

\subsubsection{Dohoda o provedení práce}
Podle §~75 zákoníku práce se dohoda o provedení práce uzavírá nejvýše na 300~hodin v~kalendářním roce (doba se u jednoho zaměstnavatele sčítá v~případě, že je dohod uzavřeno více).

\subsubsection{Dohoda o pracovní činnosti}
Podle §~76 zákoníku práce není na základě dohody o pracovní činnosti možné vykonávat práci v~rozsahu překračujícím v~průměru polovinu stanovené týdenní pracovní doby. Toto se posuzuje za celou dobu, po niž je uzavřena, nejdéle však za 52 týdnů. Musí být sjednán rozsah pracovní doby a doba, na niž se sjednává.



\chapter{Analýza systému}

%
% \section{Motivace pro softwarové řešení}
%
% TODO.
% Jak zlepšilo produktivitu adoptování systémů? Jsou zaměstnanci víc spoko? Kolik nám to ušetři peněz?
% People centric system


\section{Uživatelské role}
Jedním z~hlavních cílů celého systému na plánování směn je informovat individuálně zaměstnance o jejich vlastních směnách, proto se jeví vhodnou jeho personalizace, a to na základě uživatelských účtů. Vstupní operací bude přihlášení -- z~toho vyplývá nezbytnost existence role přihlášeného a nepřihlášeného uživatele.

Pro roli přihlášeného uživatele byla identifikována nutnost dalšího rozšíření, a to na základě pracovněprávního vztahu (tj. zaměstnanec v pracovním poměru, zaměstnanec na dohodu o provedení práce a zaměstnanec na dohodu o pracovní činnosti) a věku, resp. toho, zda je zletilý či nikoli. Důvodem pro toto rozšíření je, že každý uživatel bude moci provádět jiné operace dle odlišných pravidel. Uživatelská role ovšem není závislá na tom, zda má zaměstnanec plný nebo zkrácený úvazek, neboť v obou případech platí stejné podmínky, liší se jen týdenní pracovní doba. Stranou zůstává role, kterou má v~rámci tohoto systému zaměstnavatel či jím pověřená osoba (dále jen vedoucí), jež má zodpovědnost za rozvrhování pracovní doby. Ta by měla mít komplexní přehled o rozpisu a v~případě nutnosti i možnost do něj zasáhnout.


\section{Funkční požadavky}
Cílem této podkapitoly je formulovat funkční požadavky, tzn. jaké možnosti by měl systém poskytnout koncovým uživatelům, aniž by bylo specifikováno, jak to bude dělat \cite{lauesen2002}.

\subsubsection{Základní požadavky na systém}
\begin{enumerate}
	\item Jako nepřihlášený uživatel se chci do systému přihlásit uživatelským jménem a heslem.
	\item Jako přihlášený uživatel chci mít možnost se ze systému odhlásit.
	\item Jako uživatel chci mít možnost zobrazit si relevantní nápovědu.
\end{enumerate}

\subsubsection{Požadavky na správu směn}
\begin{enumerate}
	% \item Jako vedoucí chci vypsat časové sloty pro směny mně podřízených zaměstnanců.
	\item Jako vedoucí chci vidět komplexní rozpis směn svých podřízených.
	\item Jako vedoucí chci mít možnost změnit automaticky generovaný rozpis směn.
\end{enumerate}

\subsubsection{Požadavky na splnění legislativy}
Při implementaci systému na plánování směn je žádoucí, aby byl dohled nad dodržováním pracovněprávních předpisů, především těch, které uvádějí konkrétní kvantitativní údaje, automatizován. Proto také byly na základě legislativních podmínek z~podkapitoly~\ref{section:legislativa} stanoveny následující požadavky:

\begin{enumerate}
	\item Systém rozvrhne zaměstnancům v~pracovním poměru pracovní dobu úměrně jejich úvazku, a to vždy s~nejméně dvoutýdenním předstihem.
	\item Systém bude automaticky plánovat ideálně 8hodinové, nejdéle však 12hodinové směny.
	\item Systém při plánování směn nezletilým zaměstnancům rozvrhne v~jednom dni maximálně 8hodinové směny, jejich týdenní pracovní doba nepřekročí 40~hodin.
	\item Systém umožní zaměstnancům na dohodu o provedení práce odpracovat nejvýše 300 hodin v~kalendářním roce.

\end{enumerate}


% \section{Uživatelská práva}
% TODO.
% % Vzhledem k~tomu, že se jedná o interní systém organizace, budou práva nepřihlášeného uživatele omezena jen na velmi malou množinu operací.
%
%
% \section{Existující systémy}
% TODO.
% V~následující kapitole bude provedena analýza vybraných systémů, které lze pro plánování lidských zdrojů použít.

% Konkrétně se jedná o systémy Tamigo\footnote{https://tamigo.com}, Workforce\footnote{https://workforce.com} a When I work\footnote{https://wheniwork.com}, zmínka bude věnována i ERP systémům.


\section{UX analýza}



\chapter{Algoritmy pro rozvrhování směn}
Problém plánování směn je obecně velmi komplexní, a to i v~případě, že se řeší jen jeho zjednodušená verze (např. se vyhodnocuje jen jedno kritérium a schopnosti zaměstnanců jsou homogenní). \cite{cai2000genetic} Proto se také na jeho řešení nejčastěji používají heuristické metody.

% Operační výzkum

\section{Definice problému}
Máme k~dispozici $N$~zaměstnanců, které je třeba rozdělit do $D$~pracovních dní. V~každém pracovním dni je vypsáno několik směn (ráno, odpoledne, v~noci). Pro každou směnu je stanoven přesný počet potřebných pracovníků. Teoretickým problémem, který se týká rozvrhování lidských zdrojů a kterému je v~literatuře věnována pozornost, je tzv.~problém rozvrhování zdravotních sester (angl. nurse rostering problem nebo nurse scheduling problem). Pro vyšší obecnost a z~důvodu odlišnosti problémů zde budou \uv{sestry} nazývány jako zaměstnanci.


\section{Proces rozvrhování směn}
Dle \cite{ernst2004staff} lze proces rozvrhování rozdělit na několik modulů, které mohou, ale nemusí být postupnými kroky tohoto procesu. Konkrétně se jedná o:
\begin{enumerate}
	\item předpovídání poptávky po personálu;
	\item rozvrhování volných dnů;
	\item rozvrhování směn;
	\item rozvrhování prací;
	\item rozdělení úkolů;
	\item přidělení osob.
\end{enumerate}

\section{Podmínky}
Rozvrhování směn závisí na takovém množství podmínek, že je obvykle není možné splnit všechny, proto se také často musí před samotným řešením problému rozdělit na nezbytné~(hard, značeno $H_i$, musí být splněny vždy) a~zbytné~(soft, značeno $S_i$, jejich splnění je žádoucí). \cite{todorovic2012bee} Pro každou podmínku je třeba stanovit její váhu, nezbytné podmínky mají například váhu v~řádu vyšších stovek (mezi 500 a 1000) a zbytné podmínky mají váhu řádově menší (mezi 50 a 150). \cite{buyukozkan2014applicability}


\section{Vstupy}
Organizace má množinu zaměstnanců $E$, jejich podmnožině $M \subseteq E$ o mohutnosti $\mbox{card}~M = N$ v~daném období může být rozvrhnuta směna.

Byla použita některá z~metodik na předpovídání poptávky po personálu (viz podkapitolu \ref{sub:demand}), výsledkem je tabulka (viz např. \ref{tab:demand}), v~buňkách je potřebný počet zaměstnanců v~daném čase.

\begin{table}[h]
	\input{tables/demand-tabular.tex}
	\caption{Příklad týdenní poptávky}
	\label{tab:demand}
\end{table}

Dalším vstupem je tabulka s~nezbytnými (tab.~\ref{tab:hard}) a zbytnými (tab.~\ref{tab:soft}) požadavky.

\begin{table}[h]
	\begin{tabular}{|@{\makebox[3em][c]{${H}_{\rownumber}$}} |l|c|}
	\hline
	\multicolumn{1}{|@{\makebox[3em][c]{ID}} | l |}{ Požadavek } & Váha\\
	\hline
	Všechny směny musí být zaplněny. & 1000 \\
	{Každý pracovník může pracovat nejvýše jednu směnu denně.} & 1000 \\
	\hline
	\end{tabular}

	\caption{Příklad nezbytných podmínek}
	\label{tab:hard}

\end{table}

\begin{table}[h]
	\begin{tabular}{|@{\makebox[3em][c]{${S}_{\rownumber}$}} |p{0.8\linewidth}|c|}
	\hline
	\multicolumn{1}{|@{\makebox[3em][c]{ID}} | l |}{ Požadavek } & Váha\\
	\hline
	{Jsou dodrženy požadavky zaměstnanců na volno.} & 100 \\
	{Dvojice zaměstnanců nechce pracovat společně.} & 50 \\
	\multicolumn{1}{|@{\makebox[3em][c]{$\vdots$ }} | c |}{ $\vdots$  } & $\vdots$ \\
	\hline
	\end{tabular}

	\caption{Příklad zbytných podmínek}
	\label{tab:soft}
\end{table}

\section{Interpretace řešení}
Řešení tohoto problému lze interpretovat jako vektor $\boldsymbol{x} = (x^{1}, x^{2}, \ldots, x^{N})$, kde $x^i = (j, k, l)$, $j$ je zaměstnanec, $k$ je den a~$l$~je číslo směny. \cite{awadallah2015hybrid}


\section{Objektivní funkce}
Objektivní funkce je taková funkce, která posuzuje kvalitu řešení. Lze ji formulovat jako

\begin{equation}
	f(\boldsymbol{x}) = \sum_{s = 1}^n c_s \cdot g_s(\boldsymbol{x}),
\end{equation}
kde $\boldsymbol{x}$ je dané řešení, $n$ je počet zbytných podmínek, $c_s$ je váha~$s$-té~podmínky (také lze tento údaj chápat jako sankci za její porušení) a $g_s(\boldsymbol{x})$ je počet porušení $s$-té~podmínky v~řešení~$\boldsymbol{x}$. \cite{awadallah2015hybrid}

\section{Optimalizace včelím rojem}
Optimalizace včelím rojem (angl. bee colony optimization) je evoluční algoritmus, v~němž každá ze \uv{včel} hledá řešení. Tato heuristická metoda se~skládá ze dvou iterací, dopředné~a~zpětné, které se opakují, dokud není splněna výstupní podmínka.

\subsection{Dopředná fáze}
V~dopředné fázi každá ze včel prohledává prostor, a~to v~předdefinovaném počtu~kroků, kterými vytváří nové nebo zlepšují známé řešení. S~částečným řešením se vrací včela do úlu. \cite{teodorovic2009bee}

\subsection{Zpětná fáze}
Ve zpětné fázi si včely na základě hodnoty objektivní funkce sdílejí informace o~kvalitě svých řešení. Pak se každá včela náhodně (pravděpodobnost bude distribuována dle kvality řešení) rozhodne, zda své řešení bude prosazovat či nikoli. Pokud nepokračuje, vybere náhodně to řešení, ke kterému se přikloní, a to si zapamatuje. \cite{teodorovic2009bee}

\subsection{Algoritmus}
Máme kolonii včel o~velikosti~$B$, která může udělat $NF$ iterací. V jedné iteraci může včela udělat $NC$ konstrukčních kroků, v~každém jednotlivém konstrukčním kroku musí rozřadit $NS$~směn mezi $NS$~různých zaměstnanců. V~každém konstrukčním kroku se evaluují všechny kombinace, aby se nalezlo nejlepší řešení. \cite{khader2013artificial}

Zjednodušený průběh optimalizace včelím rojem je zobrazen na vývojovém diagramu~\ref{fig:beeflow}.
\begin{figure}[h]
	\input{img/img_bees_flow.pdf_tex}
	\caption{Zjednodušený průběh algoritmu}
	\label{fig:beeflow}
\end{figure}

V~textové podobě pak dle \cite{rajeswari2017directed} algoritmus vypadá následovně:
\begin{lstlisting}
Inicializace: Vytvoř včely.
Iteruj přes všechny včely.
	Nastav čítač na 1.
	Vyhodnoť všechny možné konstrukční kroky.
	Vyber náhodně jedno řešení.
	Zvyš čítač o 1. Jestliže je hodnota čítače menší než celkový počet konstrukčních kroků, vrať se k vykonávání řádky 4.
Vrať se do úlu.
Spočítej objektivní funkci pro každou včelu; seřaď řešení dle hodnoty.
Včela s nejlepším výsledkem se stane vedoucím.
Každá včela se náhodně stane vůdcem nebo následovníkem. Následovník zahodí své řešení.
Každý následovník se přidá k některému z vůdců a převezme jeho řešení.
Jestliže nebyla splněna výstupní podmínka, vrať se na řádku 2.
Vyhodnoť a vyber nejlepší řešení.
Vrať nejlepší řešení.
\end{lstlisting}

% PEAST algorithm = http://www.lnse.org/papers/51-CA009.pdf
% Employee scheduling in service industries with flexible employee availability and demand https://www.sciencedirect.com/science/article/pii/S0305048316000475#bib1

% \newpage
% \subsection{Rozvrhování prací}
% % TODO
% [TODO: Nechat to tu?]
%
% Mezi jednotlivými pracemi (úkoly) může být vztah precedence, tzn., že nezbytnou podmínkou pro začátek některé z~prací je ukončení jiné práce (jedná se tedy o~uspořádané dvojice). Posloupnost prací lze zobrazit do orientovaného grafu \cite{mohring2004scheduling}, který lze zobrazit dvěma způsoby, buďto jsou práce vrcholy (obr.~\ref{fig:node}), nebo jsou práce hrany (obr.~\ref{fig:arc}), v~tom případě jsou vrcholy milníky. \cite[s.~51--57]{pinedo2005planning}
%
% % % TODO obrázky
% \begin{figure}[h]
% \def\svgwidth{\columnwidth}
% \input{img/job_on_node.pdf_tex}
% \caption{Práce jako vrchol}
% \label{fig:node}
% \end{figure}
%
% \begin{figure}[h]
% \def\svgwidth{\columnwidth}
% \input{img/job_on_arc.pdf_tex}
% \caption{Práce jako hrana}
% \label{fig:arc}
% \end{figure}


\section{Cyklické rozdělení}
Hlavní myšlenkou metody cyklického rozdělení je, že směny lze mezi zaměstnance rozdělit na základě opakujících se schémat. Skládá se ze tří fází: dekompozice, konstrukce a následné zpracování. \cite{brucker2005decomposition} Hlavním problémem zde je nalezení schémat, podproblémem jejich sestavení do rozvrhu. \cite{becker2020decomposition}

\subsection{Dekompozice}
Zaměstnanci jsou rozděleni do několika skupin. Nejprve se sestaví schéma pro směny, jejichž zaplnění je nejtěžší (tzn., že způsobu jejich zaplnění se týkají největší sankce). Na základě toho se vytvoří schéma cyklicky se opakujících bloků (např. schéma pro jeden týden). Vytváření schématu pokračuje i pro další druhy směn a cílem je, aby se co nejvíce směn rozdělovalo cyklicky dle bloků a co nejméně jich bylo třeba rozdělit dodatečně.

\subsection{Konstrukce}
Směny, které nejsou rozděleny dle cyklického schématu v~první fázi, se rozdělí v~druhé fázi. Součástí může být i přesunutí některých už přiřazených směn.

\subsection{Následné zpracování}
V poslední fázi se provede opětovný průzkum prostoru. Sousedící směny se mohou přeházet, pokud se zdá, že toto řešení bude lepší. Výsledkem nemusí být cyklicky se opakující rozvrh.

\newpage
\section{Návrh vlastního algoritmu}

\subsection{Požadavky na algoritmus}
Na základě potřeb tohoto systému byly stanoveny požadavky na algoritmus uvedené v~tab.~\ref{tab:algorithm_req}. Tyto požadavky se liší od standardních požadavků na výše uvedené algoritmy pro rozvrhování zdravotních sester, neboť toto řešení předpokládá, že volné směny budou dále rozvrhnuty jiným způsobem. Zároveň je zde cílem netvořit zbytečné překážky v~zaměstnání, tedy rozvrhnout práci všem.

\begin{table}[h!]
	\input{tables/algorithm_req.tex}
	\caption{Požadavky na algoritmus}
	\label{tab:algorithm_req}
\end{table}

\subsection{Průběh}
Rozdělování směn bude probíhat po menších skupinách, prioritně se rozdělí směny pro ty zaměstnance, kteří mají nejspecifičtější požadavky (a je tedy nejtěžší je přidělit). V~počátečním stavu je rozvrh prázdný, zaměstnancům nejsou přiděleny žádné směny. Rozvrh se sestavuje po dnech, v~každém dni se rozdělí směny mezi zaměstnance z~aktuální podskupiny (viz obr. \ref{fig:dayflow}).

\begin{figure}[h]
	\input{img/flowchart-algo-day.pdf_tex}
	\caption{Zjednodušený průběh algoritmu}
	\label{fig:dayflow}
\end{figure}

Rozložení pravděpodobnosti při náhodném výběru vhodné směny\footnote{Směna vhodná pro daného zaměstnance je taková, která splňuje nezbytné požadavky -- neuvažuje se tedy např. ta směna, která začíná méně než 12~h po konci minulé směny.} nebo volna může záviset na několika faktorech, např.:
\begin{enumerate}
	\item prioritu má zaplnění rozvrhu ve všech časech, kdy jsou vypisovány směny;
	\item preferováno je zaplnění relativně ku poptávce;
	\item preferovány jsou celé 8hodinové směny\footnote{Je-li to však třeba, lze je i rozdělit.};
	\item preferováno je více dnů volna pohromadě.
\end{enumerate}


\subsection{Příklad}
Předpokládá se, že organizace má $N = 10$ zaměstnanců, kteří mají různě velký úvazek a mohou pracovat v~různé dny (tab. \ref{tab:algorithm_employees}). Všichni mají stejné schopnosti a jejich specializace není určena. Navíc byl sestaven i~model vytíženosti (je relativní; vyšší číslo značí, že v~daný čas je vyšší poptávka po zaměstnancích), který je v~tab. \ref{tab:algorithm_demand}.

\begin{table}[h]
	\input{tables/algorithm_employees.tex}
	\caption{Příklad struktury zaměstnanců}
	\label{tab:algorithm_employees}
\end{table}

\begin{table}[h]
	\input{tables/algorithm_demand.tex}
	\caption{Příklad poptávky po zaměstnancích}
	\label{tab:algorithm_demand}
\end{table}

\subsubsection{Rozdělení zaměstnanců}
V prvním kroku jsou vybráni zaměstnanci, kteří mají nejspecifičtější potřeby, tedy 9 a 10, kteří mohou pracovat nejméně dnů v~týdnu.

\paragraph{Pondělí až čtvrtek} Směny mezi tyto zaměstnance rozdělit nelze, neboť z~tab.~\ref{tab:algorithm_employees} vyplývá, že v~tyto dny není ani jeden z~těchto zaměstnanců k~dispozici.

\paragraph{Pátek až neděle} Ve~zbývajících dnech je naopak nezbytné rozvrh pro tyto zaměstnance sestavit\footnote{Předpokládá se, že za týden musí odpracovat při svém úvazku právě 20~hodin. Každý den odpracují nejvýše 8~hodin, tzn., že 20~hodin lze rozdělit mezi 3 dny.}.

\subparagraph{Pátek} Náhodná funkce přidělí zaměstnance~9 na ranní směnu (zatím v~daném čase není na pracovišti žádný zaměstnanec, navíc jde o vytížený čas, pravděpodobnost tohoto kroku je tedy nejvyšší). Zaměstnanci~10 je přidělena odpolední směna.

\subparagraph{Sobota} Zaměstnanci~9 může být přidělena ranní nebo odpolední směna, z~této množiny je mu náhodně vybrána ranní. Zaměstnanec~10 má v~sobotu specifičtější požadavky -- musí mezi směnami mít nejméně 12hodinovou přestávku, a tu by neměl, kdyby pracoval celou ranní směnu, v~úvahu tedy připadá pouze odpolední směna (celá či její část), případně část ranní směny (stále je třeba rozdělit 12~hodin mezi 2 dny). Je mu přidělena např. celá odpolední.

\subparagraph{Neděle} Zaměstnanec~9 opět může pracovat ráno i odpoledne, náhodně se vybere odpoledne, směnu je však nezbytné zkrátit (zbývá rozdělit 4~hodiny, směna má běžně 8 hodin). Je mu tedy přidělena úvodní část odpolední směny. Zaměstnanci~10 může být přidělena jen část odpolední směny, vzhledem k~tomu, že je část odpolední směny neobsazená, je mu přiřazen její konec.

Po prvním rozdělení je tak v~daném čase počet zaměstnanců dle tab.~\ref{tab:firstiteration}, rozvrh prvních dvou zaměstnanců je v~tab.~\ref{tab:firstemployees}.

\begin{table}[h]
	\input{tables/example_first_iteration.tex}
	\caption{Počet zaměstnanců v~daném čase po prvním rozdělení.}
	\label{tab:firstiteration}

\end{table}

\begin{table}[h]
	\input{tables/example_first_iteration_employees.tex}
	\caption{Směny prvních zaměstnanců po prvním rozdělení}
	\label{tab:firstemployees}

\end{table}

Postup při rozdělení dalších zaměstnanců je analogický, validním výsledkem může být například tab.~\ref{tab:exemployees}.

\begin{table}[h]
	\input{tables/example_employees.tex}
	\caption{Rozvrh směn na týden}
	\label{tab:exemployees}

\end{table}

\begin{table}[h]
	\input{tables/example_count.tex}
	\caption{Počet zaměstnanců v~daném čase}
	\label{tab:excount}

\end{table}

% \chapter{Backend}
%
%
% \section{Autentizace}
% Autentizace je realizována pomocí knihovny Devise Token Auth\footnote{\url{https://github.com/lynndylanhurley/devise_token_auth}}, server v~případě úspěšné autentizace odešle klientovi v~hlavičce token typu bearer (tzn. nositel, \uv{umožni nositeli tohoto tokenu přístup} \cite{swagger2020bearer}) s~platností na dva týdny. Akce bude uživateli umožněna v~případě, že~na server odešle v~HTTP~hlavičce spolu se svým požadavkem i~údaje o~tokenu.
%
% Hesla uživatelů se v~databázi uchovávají v~hashované podobě.
%
%
%
% \chapter{Mobilní aplikace}
%
%
% \section{Design}
%
%
%
% \chapter{Závěr}

\printbibliography[title={Seznam použité literatury}]

\end{document}
